{% extends "base.html" %}
{% block content %}
<div class="page-header">
    <h2>Welcome, {{ teacher.first_name }}!</h2>
    <p class="text-muted">{{ teacher.qualification or '' }} | {{ teacher.department.name if teacher.department else 'No
        Department' }}</p>
</div>

<!-- Quick Stats -->
<div class="row g-4 mb-4">
    <div class="col-md-3">
        <div class="card bg-primary">
            <div class="card-body text-center">
                <h2 class="mb-0">{{ today_classes|length }}</h2>
                <small>Today's Classes</small>
            </div>
        </div>
    </div>
    <div class="col-md-3">
        <div class="card">
            <div class="card-body text-center">
                <h2 class="mb-0">{{ classes_taught|length }}</h2>
                <small>Classes Assigned</small>
            </div>
        </div>
    </div>
    <div class="col-md-3">
        <div class="card">
            <div class="card-body text-center">
                <h2 class="mb-0">{{ pending_hw }}</h2>
                <small>Active Homework</small>
            </div>
        </div>
    </div>
    <div class="col-md-3">
        <div class="card bg-success">
            <div class="card-body text-center">
                <h2 class="mb-0">{{ today.strftime('%a') }}</h2>
                <small>{{ today.strftime('%b %d, %Y') }}</small>
            </div>
        </div>
    </div>
</div>

<div class="row g-4">
    <!-- Today's Schedule -->
    <div class="col-lg-6">
        <div class="card h-100">
            <div class="card-header d-flex justify-content-between">
                <span><i class="bi bi-calendar-day"></i> Today's Schedule</span>
                <a href="{{ url_for('teacher.schedule') }}" class="btn btn-sm btn-outline-light">View All</a>
            </div>
            <div class="card-body p-0">
                {% if today_classes %}
                <table class="table table-dark table-hover mb-0">
                    <thead>
                        <tr>
                            <th>Time</th>
                            <th>Subject</th>
                            <th>Class</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for t in today_classes %}
                        <tr>
                            <td>{{ t.start_time.strftime('%H:%M') if t.start_time else '' }}</td>
                            <td><strong>{{ t.subject.name if t.subject else 'N/A' }}</strong></td>
                            <td>
                                {% if t.class_info %}
                                {{ t.class_info.grade }}-{{ t.class_info.section }}
                                {% else %}
                                N/A
                                {% endif %}
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
                {% else %}
                <div class="p-4 text-center text-muted">No classes scheduled today</div>
                {% endif %}
            </div>
        </div>
    </div>

    <!-- Quick Actions -->
    <div class="col-lg-6">
        <div class="card h-100">
            <div class="card-header"><i class="bi bi-lightning"></i> Quick Actions</div>
            <div class="card-body">
                <div class="d-grid gap-3">
                    <a href="{{ url_for('teacher.mark_attendance') }}" class="btn btn-outline-success btn-lg">
                        <i class="bi bi-calendar-check"></i> Mark Attendance
                    </a>
                    <a href="{{ url_for('teacher.enter_marks') }}" class="btn btn-outline-info btn-lg">
                        <i class="bi bi-pencil-square"></i> Enter Marks
                    </a>
                    <a href="{{ url_for('teacher.schedule') }}" class="btn btn-outline-secondary btn-lg">
                        <i class="bi bi-calendar-week"></i> View Full Schedule
                    </a>
                </div>
            </div>
        </div>
    </div>

    <!-- Classes Taught -->
    <div class="col-12">
        <div class="card">
            <div class="card-header"><i class="bi bi-building"></i> My Classes</div>
            <div class="card-body">
                {% if classes_taught %}
                <div class="row g-3">
                    {% for c in classes_taught %}
                    <div class="col-md-4">
                        <div class="card bg-dark">
                            <div class="card-body text-center">
                                <h5>{{ c.grade }}-{{ c.section }}</h5>
                                <small class="text-muted">{{ c.students|length }} students</small>
                            </div>
                        </div>
                    </div>
                    {% endfor %}
                </div>
                {% else %}
                <p class="text-muted mb-0">No classes assigned yet</p>
                {% endif %}
            </div>
        </div>
    </div>
</div>
{% endblock %}